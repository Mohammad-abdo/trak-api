// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id                   Int       @id @default(autoincrement())
  firstName            String?   @map("first_name")
  lastName             String?   @map("last_name")
  email                String?   @unique
  username             String?   @unique
  password             String?
  countryCode          String?   @default("+1") @map("country_code")
  contactNumber        String?   @map("contact_number")
  gender               String?
  emailVerifiedAt      DateTime? @map("email_verified_at") @db.Timestamp
  address              String?   @db.Text
  userType             String?   @map("user_type") @db.VarChar(20)
  playerId             String?   @map("player_id")
  fcmToken             String?   @map("fcm_token")
  fleetId              Int?      @map("fleet_id")
  latitude             String?
  longitude            String?
  currentHeading       Float?    @map("current_heading")
  lastNotificationSeen DateTime? @map("last_notification_seen") @db.Timestamp
  status               String    @default("pending") @db.VarChar(20)
  isOnline             Boolean   @default(false) @map("is_online")
  isAvailable          Boolean   @default(false) @map("is_available")
  uid                  String?
  loginType            String?   @map("login_type")
  displayName          String?   @map("display_name")
  timezone             String?   @default("UTC")
  serviceId            Int?      @map("service_id")
  isVerifiedDriver     Boolean   @default(false) @map("is_verified_driver")
  lastLocationUpdateAt DateTime? @map("last_location_update_at") @db.Timestamp
  otpVerifyAt          DateTime? @map("otp_verify_at") @db.Timestamp
  lastActivedAt        DateTime? @map("last_actived_at") @db.Timestamp
  appVersion           String?   @map("app_version")
  referralCode         String?   @unique @map("referral_code")
  partnerReferralCode  String?   @map("partner_referral_code")
  rememberToken        String?   @map("remember_token")
  avatar               String?   @db.Text
  otp                  String?   @db.VarChar(10)
  otpExpiresAt         DateTime? @map("otp_expires_at") @db.Timestamp
  isVerified           Boolean   @default(false) @map("is_verified")
  createdAt            DateTime  @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt            DateTime  @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  // Relations
  fleet   User?    @relation("FleetDrivers", fields: [fleetId], references: [id])
  drivers User[]   @relation("FleetDrivers")
  service Service? @relation(fields: [serviceId], references: [id])

  // Ride requests
  riderRideRequests  RideRequest[] @relation("RiderRideRequests")
  driverRideRequests RideRequest[] @relation("DriverRideRequests")

  // Documents
  driverDocuments DriverDocument[]

  // Wallet
  wallet          Wallet?
  walletHistories WalletHistory[]

  // Bank account
  bankAccount UserBankAccount?

  // User details
  userDetail UserDetail?

  // Ratings
  riderRatings  RideRequestRating[] @relation("RiderRatings")
  driverRatings RideRequestRating[] @relation("DriverRatings")

  // Bids
  bids RideRequestBid[]

  // Complaints
  driverComplaints Complaint[] @relation("DriverComplaints")
  riderComplaints  Complaint[] @relation("RiderComplaints")

  // Withdraw requests
  withdrawRequests WithdrawRequest[]

  // Payments
  paymentsAsUser   Payment[] @relation("PaymentUser")
  paymentsAsDriver Payment[] @relation("PaymentDriver")

  // Driver services
  driverServices DriverService[]

  // Customer support
  customerSupports CustomerSupport[]

  // Admin login tracking
  adminLoginDevices AdminLoginDevice[]

  // Promotion usages (as rider)
  promotionUsages PromotionUsage[]

  // Tourist trips
  touristTripsAsRider  TouristTrip[] @relation("TouristTripRider")
  touristTripsAsDriver TouristTrip[] @relation("TouristTripDriver")

  // Dedicated private bookings (isolated feature)
  dedicatedBookingsAsUser   DedicatedBooking[] @relation("DedicatedBookingUser")
  dedicatedBookingsAsDriver DedicatedBooking[] @relation("DedicatedBookingDriver")

  // Mobile user addresses
  addresses UserAddress[]

  // Saved payment cards (last 4 digits + brand for display; never store full number)
  bankCards UserBankCard[]

  @@index([userType, status])
  @@index([email])
  @@index([contactNumber])
  @@map("users")
}

model Region {
  id           Int      @id @default(autoincrement())
  name         String?
  nameAr       String?  @map("name_ar") @db.Text
  distanceUnit String?  @default("km") @map("distance_unit")
  coordinates  Json?
  status       Int      @default(1)
  timezone     String?  @default("UTC")
  createdAt    DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt    DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  services        Service[]
  surgePrices     SurgePrice[]
  geographicZones GeographicZone[]

  @@map("regions")
}

model Service {
  id                Int      @id @default(autoincrement())
  name              String
  nameAr            String?  @map("name_ar") @db.Text
  regionId          Int?     @map("region_id")
  vehicleCategoryId Int?     @map("vehicle_category_id")
  capacity          Int?
  baseFare          Float?   @default(0) @map("base_fare") @db.Double
  minimumFare       Float?   @default(0) @map("minimum_fare") @db.Double
  minimumDistance   Float?   @default(0) @map("minimum_distance") @db.Double
  perDistance       Float?   @default(0) @map("per_distance") @db.Double
  perMinuteDrive    Float?   @default(0) @map("per_minute_drive") @db.Double
  perMinuteWait     Float?   @default(0) @map("per_minute_wait") @db.Double
  waitingTimeLimit  Float?   @default(0) @map("waiting_time_limit") @db.Double
  paymentMethod     String?  @map("payment_method")
  commissionType    String?  @map("commission_type")
  adminCommission   Float?   @map("admin_commission") @db.Double
  fleetCommission   Float?   @map("fleet_commission") @db.Double
  status            Int      @default(1)
  cancellationFee   Float?   @map("cancellation_fee") @db.Double
  description       String?  @db.Text
  descriptionAr     String?  @map("description_ar") @db.Text
  createdAt         DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt         DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  region          Region?          @relation(fields: [regionId], references: [id])
  vehicleCategory VehicleCategory? @relation(fields: [vehicleCategoryId], references: [id])
  users           User[]
  rideRequests    RideRequest[]
  driverServices  DriverService[]
  surgePrices     SurgePrice[]
  touristTrips    TouristTrip[]

  @@index([vehicleCategoryId])
  @@map("services")
}

model RideRequest {
  id                                 Int       @id @default(autoincrement())
  riderId                            Int       @map("rider_id")
  serviceId                          Int?      @map("service_id")
  vehicleCategoryId                  Int?      @map("vehicle_category_id")
  geographicZoneId                   Int?      @map("geographic_zone_id")
  datetime                           DateTime? @db.Timestamp
  isSchedule                         Boolean   @default(false) @map("is_schedule")
  scheduleDatetime                   DateTime? @map("schedule_datetime") @db.Timestamp
  isPrepaid                          Boolean   @default(false) @map("is_prepaid")
  paymentReference                   String?   @map("payment_reference")
  rideAttempt                        Int       @default(0) @map("ride_attempt")
  distanceUnit                       String?   @map("distance_unit")
  totalAmount                        Float     @default(0) @map("total_amount") @db.Double
  surgeAmount                        Float?    @default(0) @map("surge_amount") @db.Double
  subtotal                           Float     @default(0) @db.Double
  extraChargesAmount                 Float     @default(0) @map("extra_charges_amount") @db.Double
  driverId                           Int?      @map("driver_id")
  riderequestInDriverId              Int?      @map("riderequest_in_driver_id")
  riderequestInDatetime              DateTime? @map("riderequest_in_datetime") @db.Timestamp
  startLatitude                      String?   @map("start_latitude")
  startLongitude                     String?   @map("start_longitude")
  startAddress                       String?   @map("start_address") @db.Text
  endLatitude                        String?   @map("end_latitude")
  endLongitude                       String?   @map("end_longitude")
  endAddress                         String?   @map("end_address") @db.Text
  distance                           Float?    @db.Double
  baseDistance                       Float?    @map("base_distance") @db.Double
  duration                           Float?    @db.Double
  seatCount                          Float?    @default(1) @map("seat_count") @db.Double
  reason                             String?   @db.Text
  status                             String    @default("pending") @db.VarChar(20)
  internalNote                       String?   @map("internal_note") @db.Text
  driverNote                         String?   @map("driver_note") @db.Text
  rideHasBid                         Boolean   @default(false) @map("ride_has_bid")
  baseFare                           Float     @default(0) @map("base_fare") @db.Double
  minimumFare                        Float     @default(0) @map("minimum_fare") @db.Double
  perDistance                        Float     @default(0) @map("per_distance") @db.Double
  perDistanceCharge                  Float     @default(0) @map("per_distance_charge") @db.Double
  perMinuteDrive                     Float     @default(0) @map("per_minute_drive") @db.Double
  perMinuteDriveCharge               Float     @default(0) @map("per_minute_drive_charge") @db.Double
  paymentType                        String?   @map("payment_type")
  extraCharges                       Json?
  couponDiscount                     Float     @default(0) @map("coupon_discount") @db.Double
  couponCode                         Int?      @map("coupon_code")
  couponData                         Json?     @map("coupon_data")
  pricingData                        Json?     @map("pricing_data")
  otp                                String?
  cancelBy                           String?   @map("cancel_by")
  cancelationCharges                 Float     @default(0) @map("cancelation_charges") @db.Double
  waitingTime                        Float     @default(0) @map("waiting_time") @db.Double
  waitingTimeLimit                   Float     @default(0) @map("waiting_time_limit") @db.Double
  tips                               Float     @default(0) @db.Double
  perMinuteWaiting                   Float     @default(0) @map("per_minute_waiting") @db.Double
  perMinuteWaitingCharge             Float     @default(0) @map("per_minute_waiting_charge") @db.Double
  isDriverRated                      Boolean   @default(false) @map("is_driver_rated")
  isRiderRated                       Boolean   @default(false) @map("is_rider_rated")
  cancelledDriverIds                 String?   @map("cancelled_driver_ids") @db.Text
  nearbyDriverIds                    Json?     @map("nearby_driver_ids")
  rejectedBidDriverIds               Json?     @map("rejected_bid_driver_ids")
  serviceData                        Json?     @map("service_data")
  maxTimeForFindDriverForRideRequest Float?    @map("max_time_for_find_driver_for_ride_request") @db.Double
  isRideForOther                     Boolean   @default(false) @map("is_ride_for_other")
  otherRiderData                     Json?     @map("other_rider_data")
  dropLocation                       Json?     @map("drop_location")
  datetimeUtc                        DateTime? @map("datetime_utc") @db.Timestamp
  multiDropLocation                  Json?     @map("multi_drop_location")
  surcharge                          Float     @default(0) @db.Double
  discount                           Float     @default(0) @db.Double
  smsType                            String?   @map("sms_type")
  tripType                           String?   @map("trip_type")
  flightNumber                       String?   @map("flight_number")
  pickupPoint                        String?   @map("pickup_point")
  preferredPickupTime                DateTime? @map("preferred_pickup_time") @db.Timestamp
  preferredDropoffTime               DateTime? @map("preferred_dropoff_time") @db.Timestamp
  airportPickup                      Boolean   @default(false) @map("airport_pickup")
  airportDropoff                     Boolean   @default(false) @map("airport_dropoff")
  zonePickup                         Boolean   @default(false) @map("zone_pickup")
  zoneDropoff                        Boolean   @default(false) @map("zone_dropoff")
  createdAt                          DateTime  @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt                          DateTime  @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  // Relations
  rider    User      @relation("RiderRideRequests", fields: [riderId], references: [id])
  driver   User?     @relation("DriverRideRequests", fields: [driverId], references: [id])
  service  Service?  @relation(fields: [serviceId], references: [id])
  payments Payment[] @relation("RideRequestPayments")

  // Related data
  ratings        RideRequestRating[]
  bids           RideRequestBid[]
  histories      RideRequestHistory[]
  walletHistories WalletHistory[]
  complaints Complaint[]

  @@index([riderId, status])
  @@index([driverId, status])
  @@index([status])
  @@index([isSchedule, scheduleDatetime, status])
  @@index([isPrepaid, status])
  @@map("ride_requests")
}

model Payment {
  id             Int      @id @default(autoincrement())
  rideRequestId  Int      @map("ride_request_id")
  userId         Int      @map("user_id")
  driverId       Int      @map("driver_id")
  amount         Float    @db.Double
  paymentType    String   @map("payment_type")
  paymentStatus  String   @default("pending") @map("payment_status") @db.VarChar(20)
  paymentGateway String?  @map("payment_gateway")
  transactionId  String?  @map("transaction_id")
  paymentDate    DateTime @default(now()) @map("payment_date") @db.DateTime(6)
  createdAt      DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt      DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  rideRequest RideRequest @relation("RideRequestPayments", fields: [rideRequestId], references: [id])
  user        User        @relation("PaymentUser", fields: [userId], references: [id])
  driver      User        @relation("PaymentDriver", fields: [driverId], references: [id])

  @@index([userId])
  @@index([driverId])
  @@index([paymentStatus])
  @@map("payments")
}

model Wallet {
  id        Int      @id @default(autoincrement())
  userId    Int      @unique @map("user_id")
  balance   Float    @default(0) @db.Double
  currency  String   @default("USD")
  createdAt DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  user      User            @relation(fields: [userId], references: [id])
  histories WalletHistory[]

  @@map("wallets")
}

model WalletHistory {
  id              Int      @id @default(autoincrement())
  walletId        Int      @map("wallet_id")
  userId          Int      @map("user_id")
  type            String
  amount          Float    @db.Double
  balance         Float    @db.Double
  description     String?  @db.Text
  transactionType String   @map("transaction_type")
  rideRequestId   Int?     @map("ride_request_id")
  createdAt       DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt       DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  wallet      Wallet       @relation(fields: [walletId], references: [id])
  user        User         @relation(fields: [userId], references: [id])
  rideRequest RideRequest? @relation(fields: [rideRequestId], references: [id])

  @@index([walletId])
  @@index([userId])
  @@index([rideRequestId])
  @@map("wallet_histories")
}

model Coupon {
  id                 Int       @id @default(autoincrement())
  code               String?   @unique
  title              String?
  titleAr            String?   @map("title_ar") @db.Text
  couponType         String?   @map("coupon_type")
  usageLimitPerRider Int?      @map("usage_limit_per_rider")
  discountType       String?   @map("discount_type")
  discount           Float?    @db.Double
  startDate          DateTime? @map("start_date") @db.Date
  endDate            DateTime? @map("end_date") @db.Date
  minimumAmount      Float?    @map("minimum_amount") @db.Double
  maximumDiscount    Float?    @map("maximum_discount") @db.Double
  status             Int?
  description        String?   @db.Text
  descriptionAr      String?   @map("description_ar") @db.Text
  imageUrl           String?   @map("image_url") @db.VarChar(512)
  regionIds          String?   @map("region_ids") @db.Text
  serviceIds         Json?     @map("service_ids")
  createdAt          DateTime  @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt          DateTime  @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@map("coupons")
}

// ----- Promotion Engine (scalable, works with Ride + Dedicated Booking) -----
enum DiscountType {
  PERCENTAGE
  FIXED
}

enum PromotionBookingType {
  RIDE
  DEDICATED
  ALL
}

model Promotion {
  id            String               @id @default(uuid())
  code          String               @unique
  discountType  DiscountType         @map("discount_type")
  discountValue Float                @map("discount_value") @db.Double
  startDate     DateTime             @map("start_date") @db.DateTime(6)
  endDate       DateTime             @map("end_date") @db.DateTime(6)
  usageLimit    Int?                 @map("usage_limit")
  usagePerUser  Int?                 @map("usage_per_user")
  bookingType   PromotionBookingType @default(ALL) @map("booking_type")
  startHour     Int?                 @map("start_hour")
  endHour       Int?                 @map("end_hour")
  isActive      Boolean              @default(true) @map("is_active")
  imageUrl      String?              @map("image_url") @db.VarChar(512)
  createdAt     DateTime             @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt     DateTime             @updatedAt @map("updated_at") @db.DateTime(6)

  categories PromotionCategory[]
  usages     PromotionUsage[]

  @@index([code])
  @@index([isActive, startDate, endDate])
  @@map("promotions")
}

model PromotionCategory {
  id                Int    @id @default(autoincrement())
  promotionId       String @map("promotion_id")
  vehicleCategoryId Int    @map("vehicle_category_id")

  promotion       Promotion       @relation(fields: [promotionId], references: [id], onDelete: Cascade)
  vehicleCategory VehicleCategory @relation(fields: [vehicleCategoryId], references: [id], onDelete: Cascade)

  @@unique([promotionId, vehicleCategoryId])
  @@index([promotionId])
  @@index([vehicleCategoryId])
  @@map("promotion_categories")
}

model PromotionUsage {
  id          Int      @id @default(autoincrement())
  promotionId String   @map("promotion_id")
  userId      Int      @map("user_id")
  bookingId   String?  @map("booking_id") @db.VarChar(191)
  usedAt      DateTime @default(now()) @map("used_at") @db.DateTime(6)

  promotion Promotion @relation(fields: [promotionId], references: [id], onDelete: Cascade)
  user      User      @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([promotionId])
  @@index([userId])
  @@map("promotion_usages")
}

model Document {
  id            Int      @id @default(autoincrement())
  name          String
  nameAr        String?  @map("name_ar") @db.Text
  type          String?
  status        Int      @default(1)
  isRequired    Boolean  @default(false) @map("is_required")
  hasExpiryDate Boolean  @default(false) @map("has_expiry_date")
  createdAt     DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt     DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  driverDocuments DriverDocument[]

  @@map("documents")
}

model DriverDocument {
  id         Int       @id @default(autoincrement())
  driverId   Int       @map("driver_id")
  documentId Int       @map("document_id")
  isVerified Boolean   @default(false) @map("is_verified")
  expireDate DateTime? @map("expire_date") @db.Date
  createdAt  DateTime  @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt  DateTime  @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  driver   User     @relation(fields: [driverId], references: [id])
  document Document @relation(fields: [documentId], references: [id])

  @@index([driverId])
  @@index([documentId])
  @@map("driver_documents")
}

model Complaint {
  id            Int      @id @default(autoincrement())
  driverId      Int?     @map("driver_id")
  riderId       Int?     @map("rider_id")
  complaintBy   String?  @map("complaint_by")
  subject       String?
  description   String?  @db.Text
  rideRequestId Int?     @map("ride_request_id")
  status        String?  @default("pending") @db.VarChar(20)
  createdAt     DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt     DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  driver      User?              @relation("DriverComplaints", fields: [driverId], references: [id])
  rider       User?              @relation("RiderComplaints", fields: [riderId], references: [id])
  rideRequest RideRequest?       @relation(fields: [rideRequestId], references: [id])
  comments    ComplaintComment[]

  @@map("complaints")
}

model ComplaintComment {
  id          Int      @id @default(autoincrement())
  complaintId Int      @map("complaint_id")
  comment     String?  @db.Text
  createdAt   DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt   DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  complaint Complaint @relation(fields: [complaintId], references: [id])

  @@map("complaint_comments")
}

model RideRequestBid {
  id            Int      @id @default(autoincrement())
  rideRequestId Int      @map("ride_request_id")
  driverId      Int      @map("driver_id")
  bidAmount     Float?   @map("bid_amount") @db.Double
  isBidAccept   Boolean  @default(false) @map("is_bid_accept")
  notes         String?  @db.Text
  createdAt     DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt     DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  rideRequest RideRequest @relation(fields: [rideRequestId], references: [id])
  driver      User        @relation(fields: [driverId], references: [id])

  @@index([rideRequestId])
  @@index([driverId])
  @@map("ride_request_bids")
}

model RideRequestRating {
  id            Int      @id @default(autoincrement())
  rideRequestId Int      @map("ride_request_id")
  riderId       Int      @map("rider_id")
  driverId      Int      @map("driver_id")
  rating        Float    @db.Double
  comment       String?  @db.Text
  ratingBy      String?  @map("rating_by")
  createdAt     DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt     DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  rideRequest RideRequest @relation(fields: [rideRequestId], references: [id])
  rider       User        @relation("RiderRatings", fields: [riderId], references: [id])
  driver      User        @relation("DriverRatings", fields: [driverId], references: [id])

  @@index([rideRequestId])
  @@index([riderId])
  @@index([driverId])
  @@map("ride_request_ratings")
}

model RideRequestHistory {
  id            Int       @id @default(autoincrement())
  rideRequestId Int       @map("ride_request_id")
  historyType   String?   @map("history_type")
  datetime      DateTime? @db.Timestamp
  createdAt     DateTime  @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt     DateTime  @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  rideRequest RideRequest @relation(fields: [rideRequestId], references: [id])

  @@index([rideRequestId])
  @@map("ride_request_histories")
}

model WithdrawRequest {
  id        Int      @id @default(autoincrement())
  userId    Int      @map("user_id")
  amount    Float    @db.Double
  currency  String   @default("USD")
  status    Int      @default(0)
  createdAt DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  user User @relation(fields: [userId], references: [id])

  @@index([userId])
  @@index([status])
  @@map("withdraw_requests")
}

model UserDetail {
  id                Int      @id @default(autoincrement())
  userId            Int      @unique @map("user_id")
  carModel          String?  @map("car_model")
  carColor          String?  @map("car_color")
  carPlateNumber    String?  @map("car_plate_number")
  carProductionYear Int?     @map("car_production_year")
  workAddress       String?  @map("work_address")
  homeAddress       String?  @map("home_address")
  workLatitude      String?  @map("work_latitude")
  workLongitude     String?  @map("work_longitude")
  homeLatitude      String?  @map("home_latitude")
  homeLongitude     String?  @map("home_longitude")
  createdAt         DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt         DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  user User @relation(fields: [userId], references: [id])

  @@map("user_details")
}

model UserBankAccount {
  id                Int      @id @default(autoincrement())
  userId            Int      @unique @map("user_id")
  bankName          String?  @map("bank_name")
  bankCode          String?  @map("bank_code")
  accountHolderName String?  @map("account_holder_name")
  accountNumber     String?  @map("account_number")
  bankAddress       String?  @map("bank_address")
  routingNumber     String?  @map("routing_number")
  bankIban          String?  @map("bank_iban")
  bankSwift         String?  @map("bank_swift")
  createdAt         DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt         DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  user User @relation(fields: [userId], references: [id])

  @@map("user_bank_accounts")
}

model Notification {
  id             String    @id @default(uuid())
  type           String
  notifiableType String    @map("notifiable_type")
  notifiableId   Int       @map("notifiable_id")
  data           Json
  readAt         DateTime? @map("read_at") @db.Timestamp
  isRead         Boolean   @default(false) @map("is_read")
  createdAt      DateTime  @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt      DateTime  @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@index([notifiableType, notifiableId])
  @@map("notifications")
}

model Sos {
  id            Int      @id @default(autoincrement())
  userId        Int      @map("user_id")
  name          String?
  nameAr        String?  @map("name_ar") @db.Text
  contactNumber String?  @map("contact_number")
  status        Int      @default(1)
  createdAt     DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt     DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@index([userId])
  @@map("sos")
}

model PaymentGateway {
  id        Int      @id @default(autoincrement())
  title     String?
  type      String?
  status    Int      @default(1)
  isTest    Boolean  @default(true) @map("is_test")
  testValue Json?    @map("test_value")
  liveValue Json?    @map("live_value")
  createdAt DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@index([type])
  @@map("payment_gateways")
}

model PaymentMethod {
  id        Int      @id @default(autoincrement())
  name      String
  nameAr    String?  @map("name_ar") @db.Text
  code      String   @unique // card, wallet, fawry, cash
  status    Int      @default(1) // 1 = active, 0 = inactive
  sortOrder Int      @default(0) @map("sort_order")
  createdAt DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@index([status])
  @@map("payment_methods")
}

model Setting {
  id        Int      @id @default(autoincrement())
  key       String   @unique
  value     String?  @db.Text
  createdAt DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@map("settings")
}

model AppSetting {
  id        Int      @id @default(autoincrement())
  key       String   @unique
  value     String?  @db.Text
  createdAt DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@map("app_settings")
}

model Airport {
  id           Int       @id @default(autoincrement())
  airportId    String?   @map("airport_id")
  ident        String?
  type         String?
  name         String?
  latitudeDeg  Float?    @map("latitude_deg") @db.Double
  longitudeDeg Float?    @map("longitude_deg") @db.Double
  isoCountry   String?   @map("iso_country")
  isoRegion    String?   @map("iso_region")
  municipality String?
  deletedAt    DateTime? @map("deleted_at") @db.Timestamp
  createdAt    DateTime  @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt    DateTime  @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@index([airportId])
  @@map("airports")
}

model Faq {
  id         Int       @id @default(autoincrement())
  question   String?   @db.Text
  questionAr String?   @map("question_ar") @db.Text
  answer     String?   @db.Text
  answerAr   String?   @map("answer_ar") @db.Text
  type       String?
  deletedAt  DateTime? @map("deleted_at") @db.Timestamp
  createdAt  DateTime  @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt  DateTime  @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@index([type])
  @@map("faqs")
}

model Cancellation {
  id        Int      @id @default(autoincrement())
  name      String?
  nameAr    String?  @map("name_ar") @db.Text
  type      String?
  status    Int      @default(1)
  createdAt DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@index([type])
  @@map("cancellations")
}

model AdditionalFees {
  id        Int      @id @default(autoincrement())
  title     String?
  titleAr   String?  @map("title_ar") @db.Text
  status    Int      @default(1)
  createdAt DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@map("additional_fees")
}

model SurgePrice {
  id                 Int       @id @default(autoincrement())
  serviceId          Int?      @map("service_id")
  vehicleCategoryId  Int?      @map("vehicle_category_id")
  regionId           Int?      @map("region_id")
  day                Json?
  type               String?
  value              Float?    @db.Double
  fromTime           Json?     @map("from_time")
  toTime             Json?     @map("to_time")
  deletedAt          DateTime? @map("deleted_at") @db.Timestamp
  createdAt          DateTime  @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt          DateTime  @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  service         Service?        @relation(fields: [serviceId], references: [id])
  vehicleCategory VehicleCategory? @relation(fields: [vehicleCategoryId], references: [id], onDelete: SetNull)
  region          Region?         @relation(fields: [regionId], references: [id])

  @@index([regionId])
  @@index([vehicleCategoryId])
  @@map("surge_prices")
}

model ManageZone {
  id          Int      @id @default(autoincrement())
  name        String?
  latitude    String?
  longitude   String?
  description String?  @db.Text
  status      Int      @default(1)
  createdAt   DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt   DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  pickupZonePrices  ZonePrice[] @relation("PickupZone")
  dropoffZonePrices ZonePrice[] @relation("DropoffZone")

  @@map("manage_zones")
}

model ZonePrice {
  id                Int      @id @default(autoincrement())
  serviceIds        Json?    @map("service_ids")
  zonePickup        Int?     @map("zone_pickup")
  zoneDropoff       Int?     @map("zone_dropoff")
  price             Float?   @db.Double
  beyondZonePercent Float?   @map("beyond_zone_percent") @db.Double
  createdAt         DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt         DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  pickupZone  ManageZone? @relation("PickupZone", fields: [zonePickup], references: [id], onDelete: SetNull)
  dropoffZone ManageZone? @relation("DropoffZone", fields: [zoneDropoff], references: [id], onDelete: SetNull)

  @@index([zonePickup])
  @@index([zoneDropoff])
  @@map("zone_prices")
}

model DriverService {
  id        Int      @id @default(autoincrement())
  driverId  Int      @map("driver_id")
  serviceId Int      @map("service_id")
  status    Int      @default(1)
  createdAt DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  driver  User    @relation(fields: [driverId], references: [id])
  service Service @relation(fields: [serviceId], references: [id])

  @@index([driverId])
  @@index([serviceId])
  @@map("driver_services")
}

model Review {
  id            Int      @id @default(autoincrement())
  driverId      Int      @map("driver_id")
  riderId       Int      @map("rider_id")
  rideRequestId Int      @map("ride_request_id")
  driverRating  Float?   @map("driver_rating") @db.Double
  riderRating   Float?   @map("rider_rating") @db.Double
  driverReview  String?  @map("driver_review") @db.Text
  riderReview   String?  @map("rider_review") @db.Text
  createdAt     DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt     DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@index([driverId])
  @@index([riderId])
  @@index([rideRequestId])
  @@map("reviews")
}

model PushNotification {
  id        Int      @id @default(autoincrement())
  title     String?
  message   String?  @db.Text
  forRider  Boolean  @default(false) @map("for_rider")
  forDriver Boolean  @default(false) @map("for_driver")
  createdAt DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@map("push_notifications")
}

model CustomerSupport {
  id               Int      @id @default(autoincrement())
  message          String?  @db.Text
  supportType      String?  @map("support_type")
  userId           Int      @map("user_id")
  status           String?  @default("pending") @db.VarChar(20)
  resolutionDetail String?  @map("resolution_detail") @db.Text
  createdAt        DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt        DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  user          User                 @relation(fields: [userId], references: [id])
  chatHistories SupportChathistory[]

  @@index([userId])
  @@index([status])
  @@map("customer_supports")
}

model SupportChathistory {
  id         Int      @id @default(autoincrement())
  supportId  Int      @map("support_id")
  message    String?  @db.Text
  senderType String?  @map("sender_type")
  createdAt  DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt  DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  support CustomerSupport @relation(fields: [supportId], references: [id])

  @@index([supportId])
  @@map("support_chathistories")
}

model AdminLoginDevice {
  id        Int       @id @default(autoincrement())
  userId    Int       @map("user_id")
  ipAddress String?   @map("ip_address")
  userAgent String?   @map("user_agent")
  loginAt   DateTime? @map("login_at") @db.Timestamp
  logoutAt  DateTime? @map("logout_at") @db.Timestamp
  isActive  Boolean   @default(true) @map("is_active")
  sessionId String?   @map("session_id")
  createdAt DateTime  @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt DateTime  @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  user User @relation(fields: [userId], references: [id])

  @@index([userId])
  @@map("admin_login_devices")
}

model AdminLoginHistory {
  id              Int      @id @default(autoincrement())
  userId          Int?     @map("user_id")
  ipAddress       String?  @map("ip_address")
  city            String?
  region          String?
  country         String?
  latLong         String?  @map("lat_long")
  org             String?
  postalCode      String?  @map("postal_code")
  timezone        String?
  browser         String?
  browserVersion  String?  @map("browser_version")
  platform        String?
  platformVersion String?  @map("platform_version")
  device          String?
  isMobile        Boolean  @default(false) @map("is_mobile")
  isDesktop       Boolean  @default(false) @map("is_desktop")
  isTablet        Boolean  @default(false) @map("is_tablet")
  createdAt       DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt       DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@index([userId])
  @@map("admin_login_history")
}

model Pages {
  id            Int      @id @default(autoincrement())
  title         String?
  titleAr       String?  @map("title_ar") @db.Text
  description   String?  @db.Text
  descriptionAr String?  @map("description_ar") @db.Text
  slug          String?  @unique
  status        Int      @default(1)
  createdAt     DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt     DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@index([slug])
  @@map("pages")
}

model MailTemplate {
  id          Int      @id @default(autoincrement())
  subject     String?
  description String?  @db.LongText
  type        String?
  createdAt   DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt   DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@index([type])
  @@map("mail_templates")
}

model LanguageDefaultList {
  id           Int      @id @default(autoincrement())
  languageName String?  @map("languageName")
  languageCode String?  @map("languageCode")
  countryCode  String?  @map("countryCode")
  createdAt    DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt    DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  languageLists LanguageList[]

  @@map("language_default_lists")
}

model LanguageList {
  id           Int      @id @default(autoincrement())
  languageId   Int?     @map("language_id")
  languageName String?  @map("language_name")
  languageCode String?  @map("language_code")
  countryCode  String?  @map("country_code")
  languageFlag String?  @map("language_flag")
  isRtl        Int      @default(0) @map("is_rtl")
  isDefault    Int      @default(0) @map("is_default")
  status       Int      @default(0)
  createdAt    DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt    DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  languageDefaultList  LanguageDefaultList?  @relation(fields: [languageId], references: [id])
  languageWithKeywords LanguageWithKeyword[]

  @@index([languageId])
  @@index([status])
  @@map("language_lists")
}

model LanguageVersionDetail {
  id                Int      @id @default(autoincrement())
  defaultLanguageId Int?     @map("default_language_id")
  versionNo         Int      @default(1) @map("version_no")
  createdAt         DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt         DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@map("language_version_details")
}

model Screen {
  id         Int      @id @default(autoincrement())
  screenId   Int?     @map("screenId")
  screenName String?  @map("screenName")
  createdAt  DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt  DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  defaultKeywords      DefaultKeyword[]
  languageWithKeywords LanguageWithKeyword[]

  @@index([screenId])
  @@map("screens")
}

model DefaultKeyword {
  id           Int      @id @default(autoincrement())
  screenId     Int?     @map("screen_id")
  keywordId    Int?     @map("keyword_id")
  keywordName  String?  @map("keyword_name")
  keywordValue String?  @map("keyword_value")
  createdAt    DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt    DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  screen               Screen?               @relation(fields: [screenId], references: [id])
  languageWithKeywords LanguageWithKeyword[]

  @@index([screenId])
  @@index([keywordId])
  @@map("default_keywords")
}

model LanguageWithKeyword {
  id           Int      @id @default(autoincrement())
  languageId   Int      @map("language_id")
  keywordId    Int?     @map("keyword_id")
  screenId     Int?     @map("screen_id")
  keywordValue String?  @map("keyword_value")
  createdAt    DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt    DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  languageList   LanguageList    @relation(fields: [languageId], references: [id])
  defaultKeyword DefaultKeyword? @relation(fields: [keywordId], references: [id])
  screen         Screen?         @relation(fields: [screenId], references: [id])

  @@index([languageId])
  @@index([keywordId])
  @@index([screenId])
  @@map("language_with_keywords")
}

model FrontendData {
  id            Int      @id @default(autoincrement())
  title         String?
  titleAr       String?  @map("title_ar") @db.Text
  subtitle      String?
  subtitleAr    String?  @map("subtitle_ar") @db.Text
  type          String?
  description   String?  @db.Text
  descriptionAr String?  @map("description_ar") @db.Text
  createdAt     DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt     DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@index([type])
  @@map("frontend_data")
}

model SMSSetting {
  id        Int      @id @default(autoincrement())
  title     String?
  type      String?
  status    Int      @default(1)
  values    Json?
  createdAt DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  smsTemplates SMSTemplatRide[]

  @@index([type])
  @@map("s_m_s_settings")
}

model SMSTemplatRide {
  id             Int      @id @default(autoincrement())
  subject        String?
  smsDescription String?  @map("sms_description") @db.Text
  smsId          Int?     @map("sms_id")
  type           String?
  rideStatus     String?  @map("ride_status")
  createdAt      DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt      DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  smsSetting SMSSetting? @relation(fields: [smsId], references: [id])

  @@index([smsId])
  @@index([type])
  @@map("s_m_s_templat_rides")
}

model Permission {
  id        Int      @id @default(autoincrement())
  name      String
  guardName String   @default("web") @map("guard_name")
  parentId  Int?     @map("parent_id")
  createdAt DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  parent         Permission?  @relation("PermissionParent", fields: [parentId], references: [id])
  subpermissions Permission[] @relation("PermissionParent")

  @@unique([name, guardName])
  @@index([guardName])
  @@index([parentId])
  @@map("permissions")
}

model Role {
  id        Int      @id @default(autoincrement())
  name      String
  guardName String   @default("web") @map("guard_name")
  createdAt DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  @@unique([name, guardName])
  @@index([guardName])
  @@map("roles")
}

// ===================================
// Multi-Service Platform Models
// ===================================

model ServiceCategory {
  id            Int      @id @default(autoincrement())
  name          String
  nameAr        String?  @map("name_ar") @db.Text
  slug          String   @unique
  description   String?  @db.Text
  descriptionAr String?  @map("description_ar") @db.Text
  icon          String?
  imageUrl      String?  @map("image_url") @db.VarChar(512)
  status        Int      @default(1)
  createdAt     DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt     DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  vehicleCategories VehicleCategory[]

  @@index([status])
  @@map("service_categories")
}

model VehicleCategory {
  id                Int      @id @default(autoincrement())
  serviceCategoryId Int      @map("service_category_id")
  name              String
  nameAr            String?  @map("name_ar") @db.Text
  slug              String   @unique
  description       String?  @db.Text
  descriptionAr     String?  @map("description_ar") @db.Text
  icon              String?
  image             String?
  capacity          Int?
  maxLoad           Float?   @map("max_load") @db.Double
  status            Int      @default(1)
  createdAt         DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt         DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  serviceCategory     ServiceCategory     @relation(fields: [serviceCategoryId], references: [id])
  features            CategoryFeature[]
  zones               CategoryZone[]
  pricingRules        PricingRule[]
  services            Service[]
  surgePrices         SurgePrice[]
  touristTrips        TouristTrip[]
  dedicatedBookings   DedicatedBooking[]
  promotionCategories PromotionCategory[]
  shipmentSizes       ShipmentSize[]
  shipmentWeights     ShipmentWeight[]

  @@index([serviceCategoryId])
  @@index([status])
  @@map("vehicle_categories")
}

model CategoryFeature {
  id                Int      @id @default(autoincrement())
  vehicleCategoryId Int      @map("vehicle_category_id")
  name              String
  nameAr            String?  @map("name_ar") @db.Text
  icon              String?
  status            Int      @default(1)
  createdAt         DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt         DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  vehicleCategory VehicleCategory @relation(fields: [vehicleCategoryId], references: [id], onDelete: Cascade)

  @@index([vehicleCategoryId])
  @@map("category_features")
}

model GeographicZone {
  id          Int      @id @default(autoincrement())
  name        String
  nameAr      String?  @map("name_ar") @db.Text
  regionId    Int?     @map("region_id")
  coordinates Json?
  centerLat   Float?   @map("center_lat") @db.Double
  centerLng   Float?   @map("center_lng") @db.Double
  radius      Float?   @db.Double
  status      Int      @default(1)
  createdAt   DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt   DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  region        Region?        @relation(fields: [regionId], references: [id])
  categoryZones CategoryZone[]

  @@index([regionId])
  @@index([status])
  @@map("geographic_zones")
}

model CategoryZone {
  id                Int      @id @default(autoincrement())
  vehicleCategoryId Int      @map("vehicle_category_id")
  geographicZoneId  Int      @map("geographic_zone_id")
  status            Int      @default(1)
  createdAt         DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt         DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  vehicleCategory VehicleCategory @relation(fields: [vehicleCategoryId], references: [id], onDelete: Cascade)
  geographicZone  GeographicZone  @relation(fields: [geographicZoneId], references: [id], onDelete: Cascade)

  @@unique([vehicleCategoryId, geographicZoneId])
  @@index([vehicleCategoryId])
  @@index([geographicZoneId])
  @@map("category_zones")
}

model PricingRule {
  id                   Int      @id @default(autoincrement())
  vehicleCategoryId    Int      @map("vehicle_category_id")
  baseFare             Float    @map("base_fare") @db.Double
  baseDistance         Float    @default(5.0) @map("base_distance") @db.Double
  minimumFare          Float    @map("minimum_fare") @db.Double
  perDistanceAfterBase Float    @map("per_distance_after_base") @db.Double
  perMinuteDrive       Float?   @default(0) @map("per_minute_drive") @db.Double
  perMinuteWait        Float?   @default(0) @map("per_minute_wait") @db.Double
  waitingTimeLimit     Float?   @default(0) @map("waiting_time_limit") @db.Double
  cancellationFee      Float?   @default(0) @map("cancellation_fee") @db.Double
  commissionType       String?  @map("commission_type")
  adminCommission      Float?   @default(0) @map("admin_commission") @db.Double
  fleetCommission      Float?   @default(0) @map("fleet_commission") @db.Double
  status               Int      @default(1)
  createdAt            DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt            DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  vehicleCategory VehicleCategory @relation(fields: [vehicleCategoryId], references: [id], onDelete: Cascade)

  @@index([vehicleCategoryId])
  @@index([status])
  @@map("pricing_rules")
}

model TouristTrip {
  id                      Int      @id @default(autoincrement())
  riderId                 Int      @map("rider_id")
  driverId                Int?     @map("driver_id")
  vehicleCategoryId       Int?     @map("vehicle_category_id")
  serviceId               Int?     @map("service_id")
  startDate               DateTime @map("start_date") @db.DateTime(6)
  endDate                 DateTime @map("end_date") @db.DateTime(6)
  startLocation           String?  @map("start_location") @db.Text
  startLatitude           String?  @map("start_latitude")
  startLongitude          String?  @map("start_longitude")
  destinations            Json?
  totalAmount             Float    @default(0) @map("total_amount") @db.Double
  paymentStatus           String   @default("pending") @map("payment_status") @db.VarChar(20)
  paymentType             String?  @map("payment_type")
  requiresDedicatedDriver Boolean  @default(true) @map("requires_dedicated_driver")
  notes                   String?  @db.Text
  notesAr                 String?  @map("notes_ar") @db.Text
  status                  String   @default("pending") @db.VarChar(20)
  createdAt               DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt               DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  rider           User             @relation("TouristTripRider", fields: [riderId], references: [id])
  driver          User?            @relation("TouristTripDriver", fields: [driverId], references: [id])
  vehicleCategory VehicleCategory? @relation(fields: [vehicleCategoryId], references: [id])
  service         Service?         @relation(fields: [serviceId], references: [id])

  @@index([riderId])
  @@index([driverId])
  @@index([status])
  @@map("tourist_trips")
}

// ========== DEDICATED PRIVATE BOOKING SYSTEM (isolated feature) ==========

enum BookingStatus {
  PENDING
  APPROVED
  DRIVER_ASSIGNED
  ON_THE_WAY
  ACTIVE
  COMPLETED
  CANCELLED
  EXPIRED
}

enum PaymentStatus {
  UNPAID
  PREAUTHORIZED
  CAPTURED
  FAILED
  REFUNDED
}

model DedicatedBooking {
  id                String @id @default(uuid())
  userId            Int    @map("user_id")
  driverId          Int?   @map("driver_id")
  vehicleCategoryId Int    @map("vehicle_category_id")

  pickupAddress String @map("pickup_address") @db.VarChar(500)
  pickupLat     Float  @map("pickup_lat") @db.Double
  pickupLng     Float  @map("pickup_lng") @db.Double

  dropoffAddress String @map("dropoff_address") @db.VarChar(500)
  dropoffLat     Float  @map("dropoff_lat") @db.Double
  dropoffLng     Float  @map("dropoff_lng") @db.Double

  bookingDate   DateTime @map("booking_date") @db.Date
  startTime     DateTime @map("start_time") @db.DateTime(6)
  durationHours Int      @map("duration_hours")

  pricingType  String? @default("PER_HOUR") @map("pricing_type") @db.VarChar(20)
  distanceKm   Float?  @map("distance_km") @db.Double
  numberOfDays Int?    @map("number_of_days")

  baseFare     Float @map("base_fare") @db.Double
  pricePerHour Float @map("price_per_hour") @db.Double
  totalPrice   Float @map("total_price") @db.Double

  status        BookingStatus @default(PENDING)
  paymentStatus PaymentStatus @default(UNPAID) @map("payment_status")

  startedAt   DateTime? @map("started_at") @db.DateTime(6)
  endedAt     DateTime? @map("ended_at") @db.DateTime(6)
  cancelledAt DateTime? @map("cancelled_at") @db.DateTime(6)

  notes                 String?  @db.Text
  stripePaymentIntentId String?  @map("stripe_payment_intent_id")
  createdAt             DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt             DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  user            User            @relation("DedicatedBookingUser", fields: [userId], references: [id])
  driver          User?           @relation("DedicatedBookingDriver", fields: [driverId], references: [id])
  vehicleCategory VehicleCategory @relation(fields: [vehicleCategoryId], references: [id])

  invoice         BookingInvoice?
  locationUpdates BookingLocationUpdate[]

  @@index([userId])
  @@index([driverId])
  @@index([vehicleCategoryId])
  @@index([status])
  @@index([bookingDate])
  @@index([startTime])
  @@map("dedicated_bookings")
}

model BookingInvoice {
  id        Int       @id @default(autoincrement())
  bookingId String    @unique @map("booking_id")
  subtotal  Float     @db.Double
  tax       Float     @default(0) @db.Double
  discount  Float     @default(0) @db.Double
  total     Float     @db.Double
  issuedAt  DateTime  @map("issued_at") @db.DateTime(6)
  paidAt    DateTime? @map("paid_at") @db.DateTime(6)

  booking DedicatedBooking @relation(fields: [bookingId], references: [id], onDelete: Cascade)

  @@map("booking_invoices")
}

model BookingLocationUpdate {
  id        Int      @id @default(autoincrement())
  bookingId String   @map("booking_id")
  lat       Float    @db.Double
  lng       Float    @db.Double
  createdAt DateTime @default(now()) @map("created_at") @db.DateTime(6)

  booking DedicatedBooking @relation(fields: [bookingId], references: [id], onDelete: Cascade)

  @@index([bookingId])
  @@map("booking_location_updates")
}

//     ( :       + /)
model DedicatedBookingPricing {
  id           Int      @id @default(autoincrement())
  pricePerKm   Float    @default(0) @map("price_per_km") @db.Double
  pricePerDay  Float    @default(0) @map("price_per_day") @db.Double
  pricePerTrip Float    @default(0) @map("price_per_trip") @db.Double
  baseFare     Float    @default(0) @map("base_fare") @db.Double
  pricePerHour Float    @default(0) @map("price_per_hour") @db.Double
  updatedAt    DateTime @updatedAt @map("updated_at") @db.DateTime(6)

  @@map("dedicated_booking_pricing")
}

// ===================================
// Mobile User App Models
// ===================================

model UserAddress {
  id        Int      @id @default(autoincrement())
  userId    Int      @map("user_id")
  title     String?
  address   String?  @db.Text
  latitude  String?
  longitude String?
  isDefault Boolean  @default(false) @map("is_default")
  createdAt DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@map("user_addresses")
}

model UserBankCard {
  id             Int      @id @default(autoincrement())
  userId         Int      @map("user_id")
  cardHolderName String?  @map("card_holder_name") @db.VarChar(100)
  lastFourDigits String   @map("last_four_digits") @db.VarChar(4)
  brand          String?  @db.VarChar(20)
  expiryMonth    Int?     @map("expiry_month")
  expiryYear     Int?     @map("expiry_year")
  isDefault      Boolean  @default(false) @map("is_default")
  createdAt      DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt      DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@map("user_bank_cards")
}

model ShipmentSize {
  id                Int      @id @default(autoincrement())
  vehicleCategoryId Int      @map("vehicle_category_id")
  name              String
  priceModifier     Float    @default(0) @map("price_modifier") @db.Double
  status            Int      @default(1)
  createdAt         DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt         DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  vehicleCategory VehicleCategory @relation(fields: [vehicleCategoryId], references: [id], onDelete: Cascade)

  @@index([vehicleCategoryId])
  @@map("shipment_sizes")
}

model ShipmentWeight {
  id                Int      @id @default(autoincrement())
  vehicleCategoryId Int      @map("vehicle_category_id")
  name              String
  priceModifier     Float    @default(0) @map("price_modifier") @db.Double
  status            Int      @default(1)
  createdAt         DateTime @default(now()) @map("created_at") @db.DateTime(6)
  updatedAt         DateTime @default(now()) @updatedAt @map("updated_at") @db.DateTime(6)

  vehicleCategory VehicleCategory @relation(fields: [vehicleCategoryId], references: [id], onDelete: Cascade)

  @@index([vehicleCategoryId])
  @@map("shipment_weights")
}
